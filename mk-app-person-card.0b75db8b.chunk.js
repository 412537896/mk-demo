webpackJsonp([17],{1727:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,s,o=r(2),i=n(o),c=r(59),u=n(c),d=r(4),f=n(d),p=r(10),m=n(p),l=r(8),h=n(l),v=r(9),k=n(v),b=r(0),w=(n(b),r(282)),x=r(670),y=n(x),g=(a=(0,w.wrapper)(y.default))(s=function(e){function t(){return(0,f.default)(this,t),(0,h.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,k.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){return this.props.monkeyKing((0,i.default)({},this.props,{path:"root"}))}}]),t}(b.Component))||s;t.default=g,e.exports=t.default},1728:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=new v.action(e),r=new y((0,o.default)({},e,{metaAction:t})),n=(0,o.default)({},t,r);return t.config({metaHandlers:n}),n}Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),o=n(s),i=r(60),c=n(i),u=r(618),d=n(u),f=r(619),p=n(f),m=r(4),l=n(m);t.default=a;var h=r(0),v=(n(h),r(282)),k=r(80),b=r(6),w=(n(b),r(632)),x=n(w),y=function e(t){var r=this;(0,l.default)(this,e),this.onInit=function(e){var t=e.component,n=e.injections;r.component=t,r.injections=n,r.component.props.setOkListener&&r.component.props.setOkListener(r.onOk),n.reduce("init",{isPop:r.component.props.isPop}),r.load()},this.load=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,r.webapi.department.query();case 3:if(n=e.sent,t.departments=n,!r.component.props.personId&&0!=r.component.props.personId){e.next=10;break}return e.next=8,r.webapi.person.findById(r.component.props.personId);case 8:n=e.sent,t.person=n;case 10:r.injections.reduce("load",t);case 11:case"end":return e.stop()}},e,r)})),this.onOk=function(){return new c.default(function(){var e=(0,p.default)(d.default.mark(function e(t,n){var a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.save();case 2:a=e.sent,t(!1===a?!1:!0);case 4:case"end":return e.stop()}},e,r)}));return function(t,r){return e.apply(this,arguments)}}())},this.save=(0,p.default)(d.default.mark(function e(){var t,n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("error"!=r.checkName(!0).status&&"error"!=r.checkMobile(!0).status){e.next=3;break}return r.injections.reduce("setCheckFields",["data.form.name","data.form.sex","data.form.mobile","data.form.birthday"]),e.abrupt("return",!1);case 3:if(t=r.metaAction.gf("data.form").toJS(),t.birthday=t.birthday.format("YYYY-MM-DD"),!t.id&&0!=t.id){e.next=12;break}return e.next=8,r.webapi.person.update(t);case 8:n=e.sent,n&&(r.metaAction.toast("success","保存人员成功"),r.injections.reduce("setPerson",n)),e.next=16;break;case 12:return e.next=14,r.webapi.person.create(t);case 14:a=e.sent,a&&(r.metaAction.toast("success","保存人员成功"),r.injections.reduce("setPerson",a));case 16:case"end":return e.stop()}},e,r)})),this.add=function(){r.injections.reduce("setPerson",{id:void 0,name:"",sex:"0",birthday:"1980-01-01",mobile:"",dept:void 0,address:"北京海淀"})},this.prev=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metaAction.gf("data.form.id"),e.next=3,r.webapi.person.prev(t);case 3:n=e.sent,n&&r.injections.reduce("setPerson",n);case 5:case"end":return e.stop()}},e,r)})),this.next=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metaAction.gf("data.form.id"),e.next=3,r.webapi.person.next(t);case 3:n=e.sent,n&&r.injections.reduce("setPerson",n);case 5:case"end":return e.stop()}},e,r)})),this.checkName=function(e){var t=r.metaAction.gf("data.other.checkFields")||(0,k.List)();return!0===e||t.includes("data.form.name")?r.metaAction.gf("data.form.name")?{status:"success"}:{status:"error",message:"请录入姓名"}:{}},this.checkMobile=function(e){var t=r.metaAction.gf("data.other.checkFields")||(0,k.List)();return!0===e||t.includes("data.form.mobile")?r.metaAction.gf("data.form.mobile")?{status:"success"}:{status:"error",message:"请录入手机号"}:{}},this.departmentFocus=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.webapi.department.query();case 2:t=e.sent,r.metaAction.sf("data.other.departments",(0,k.fromJS)(t));case 4:case"end":return e.stop()}},e,r)})),this.addDepartment=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.config.apps["mk-app-department-card"]){e.next=2;break}throw"依赖mk-app-department-card app,请使用mk clone mk-app-department-card命令添加";case 2:return e.next=4,r.metaAction.modal("show",{title:"新增部门",children:r.metaAction.loadApp("mk-app-department-card",{store:r.component.props.store})});case 4:t=e.sent,t&&r.injections.reduce("addDepartment",t);case 6:case"end":return e.stop()}},e,r)})),this.metaAction=t.metaAction,this.config=x.default.current,this.webapi=this.config.webapi};e.exports=t.default},1729:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=new m.reducer(e),r=new b((0,u.default)({},e,{metaReducer:t}));return(0,u.default)({},t,r)}Object.defineProperty(t,"__esModule",{value:!0});var s,o,i,c=r(2),u=n(c),d=r(4),f=n(d);t.default=a;var p=r(80),m=r(282),l=r(632),h=(n(l),r(6)),v=n(h),k=r(671),b=(o=s=function e(t){(0,f.default)(this,e),i.call(this),this.metaReducer=t.metaReducer},i=function(){var e=this;this.init=function(t,r){return e.metaReducer.init(t,(0,k.getInitState)(r))},this.load=function(t,r){var n=r.person,a=r.departments;return n&&(t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)((0,u.default)({},n,{birthday:(0,v.default)(n.birthday)})))),e.metaReducer.sf(t,"data.other.departments",(0,p.fromJS)(a))},this.setPerson=function(t,r){return t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)((0,u.default)({},r,{birthday:(0,v.default)(r.birthday)}))),e.metaReducer.sf(t,"data.other.checkFields",(0,p.List)())},this.setField=function(t,r,n){return t=e.metaReducer.setField(t,r,n),e.setCheckFields(t,r)},this.setCheckFields=function(t,r){if(!r)return t;var n=e.metaReducer.gf(t,"data.other.checkFields")||(0,p.List)();return"string"==typeof r?(n=n.includes(r)?n:n.push(r),e.metaReducer.sf(t,"data.other.checkFields",n)):r instanceof Array?(r.forEach(function(e){n=n.includes(e)?n:n.push(e)}),e.metaReducer.sf(t,"data.other.checkFields",n)):t},this.addDepartment=function(t,r){var n=(r.id,r.code);r.name;return e.metaReducer.sf(t,"data.form.department",n)}},o);e.exports=t.default}});