webpackJsonp([12],{1902:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,o,u=n(2),s=r(u),c=n(46),i=r(c),d=n(5),f=r(d),p=n(10),l=r(p),m=n(8),h=r(m),v=n(9),x=r(v),b=n(0),k=(r(b),n(255)),w=n(692),_=r(w),A=(a=(0,k.wrapper)(_.default))(o=function(e){function t(){return(0,f.default)(this,t),(0,h.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,x.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return this.props.monkeyKing((0,s.default)({},this.props,{path:"root"}))}}]),t}(b.Component))||o;t.default=A,e.exports=t.default},1903:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=new x.action(e),n=j.default.actionCreator((0,i.default)({},e,{metaAction:t})),r=new g((0,i.default)({},e,{metaAction:t,extendAction:n})),a=(0,i.default)({},t,n.formAction,r);return t.config({metaHandlers:a}),a}Object.defineProperty(t,"__esModule",{value:!0});var o,u,s,c=n(2),i=r(c),d=n(575),f=r(d),p=n(576),l=r(p),m=n(5),h=r(m);t.default=a;var v=n(0),x=(r(v),n(255)),b=n(72),k=n(6),w=(r(k),n(608)),_=r(w),A=n(2096),j=r(A),g=(u=o=function e(t){(0,h.default)(this,e),s.call(this),this.metaAction=t.metaAction,this.extendAction=t.extendAction,this.config=_.default.current,this.webapi=this.config.webapi},s=function(){var e=this;this.onInit=function(t){var n=t.component,r=t.injections;e.extendAction.formAction.onInit({component:n,injections:r}),e.component=n,e.injections=r,e.component.props.setOkListener&&e.component.props.setOkListener(e.onOk),r.reduce("init",{isPop:e.component.props.isPop}),e.load()},this.load=(0,l.default)(f.default.mark(function t(){var n,r;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={},t.next=3,e.webapi.department.query();case 3:if(r=t.sent,n.departments=r,!e.component.props.personId&&0!=e.component.props.personId){t.next=10;break}return t.next=8,e.webapi.person.findById(e.component.props.personId);case 8:r=t.sent,n.person=r;case 10:e.injections.reduce("load",n);case 11:case"end":return t.stop()}},t,e)})),this.onOk=(0,l.default)(f.default.mark(function t(){return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.save();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,e)})),this.save=(0,l.default)(f.default.mark(function t(){var n,r,a,o;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.metaAction.gf("data.form").toJS(),t.next=3,e.extendAction.formAction.check([{path:"data.form.name",value:n.name},{path:"data.form.mobile",value:n.mobile}],e.check);case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return",!1);case 6:if(!n.id&&0!=n.id){t.next=13;break}return t.next=9,e.webapi.person.update(n);case 9:a=t.sent,a&&(e.metaAction.toast("success","保存人员成功"),e.injections.reduce("setPerson",a)),t.next=17;break;case 13:return t.next=15,e.webapi.person.create(n);case 15:o=t.sent,o&&(e.metaAction.toast("success","保存人员成功"),e.injections.reduce("setPerson",o));case 17:return t.abrupt("return",!0);case 18:case"end":return t.stop()}},t,e)})),this.add=function(){e.injections.reduce("setPerson",{id:void 0,name:"",sex:"0",birthday:"1980-01-01",mobile:"",dept:void 0,address:"北京海淀"})},this.prev=(0,l.default)(f.default.mark(function t(){var n,r;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.metaAction.gf("data.form.id"),t.next=3,e.webapi.person.prev(n);case 3:r=t.sent,r&&e.injections.reduce("setPerson",r);case 5:case"end":return t.stop()}},t,e)})),this.next=(0,l.default)(f.default.mark(function t(){var n,r;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.metaAction.gf("data.form.id"),t.next=3,e.webapi.person.next(n);case 3:r=t.sent,r&&e.injections.reduce("setPerson",r);case 5:case"end":return t.stop()}},t,e)})),this.check=function(){var t=(0,l.default)(f.default.mark(function t(n){var r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.path){e.next=2;break}return e.abrupt("return");case 2:if("data.form.name"!=n.path){e.next=6;break}return e.abrupt("return",{errorPath:"data.other.error.name",message:n.value?"":"请录入姓名"});case 6:if("data.form.mobile"!=n.path){e.next=10;break}return r=void 0,n.value?/^1[3|4|5|8][0-9]\d{8}$/.test(n.value)||(r="请录入有效的手机号"):r="请录入手机号",e.abrupt("return",{errorPath:"data.other.error.mobile",message:r});case 10:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),this.departmentFocus=(0,l.default)(f.default.mark(function t(){var n;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.webapi.department.query();case 2:n=t.sent,e.metaAction.sf("data.other.departments",(0,b.fromJS)(n));case 4:case"end":return t.stop()}},t,e)})),this.addDepartment=(0,l.default)(f.default.mark(function t(){var n;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.config.apps["mk-app-department-card"]){t.next=2;break}throw"依赖mk-app-department-card app,请使用mk clone mk-app-department-card命令添加";case 2:return t.next=4,e.metaAction.modal("show",{title:"新增部门",children:e.metaAction.loadApp("mk-app-department-card",{store:e.component.props.store})});case 4:n=t.sent,n&&e.injections.reduce("addDepartment",n);case 6:case"end":return t.stop()}},t,e)})),this.fieldChange=function(t,n){e.extendAction.formAction.fieldChange(t,n,e.check)}},u);e.exports=t.default},1904:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=new l.reducer(e),n=new x((0,i.default)({},e,{metaReducer:t}));return(0,i.default)({},t,n)}Object.defineProperty(t,"__esModule",{value:!0});var o,u,s,c=n(2),i=r(c),d=n(5),f=r(d);t.default=a;var p=n(72),l=n(255),m=n(608),h=(r(m),n(6)),v=(r(h),n(693)),x=(u=o=function e(t){(0,f.default)(this,e),s.call(this),this.metaReducer=t.metaReducer},s=function(){var e=this;this.init=function(t,n){return e.metaReducer.init(t,(0,v.getInitState)(n))},this.load=function(t,n){var r=n.person,a=n.departments;return r&&(t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)(r))),e.metaReducer.sf(t,"data.other.departments",(0,p.fromJS)(a))},this.setPerson=function(t,n){return t=e.metaReducer.sf(t,"data.form",(0,p.fromJS)(n)),e.metaReducer.sf(t,"data.other.checkFields",(0,p.List)())},this.addDepartment=function(t,n){var r=(n.id,n.code);n.name;return e.metaReducer.sf(t,"data.form.department",r)}},u);e.exports=t.default},2076:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2077),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={action:a.default},e.exports=t.default},2077:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(52),o=r(a),u=n(575),s=r(u),c=n(576),i=r(c),d=n(5),f=r(d),p=n(11),l=r(p),m=n(14),h=(r(m),function e(t){(0,f.default)(this,e),v.call(this),this.metaAction=t.metaAction}),v=function(){var e=this;this.onInit=function(t){var n=t.component,r=t.injections;e.component=n,e.injections=r},this.fieldChange=function(){var t=(0,i.default)(s.default.mark(function t(n,r,a){return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.check([{path:n,value:r}],a,!0);case 2:case"end":return t.stop()}},t,e)}));return function(e,n,r){return t.apply(this,arguments)}}(),this.check=function(){var t=(0,i.default)(s.default.mark(function t(n,r,a){var u,c,i,d,f,p,m,h,v,x;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&l.default._.isArray(n)){t.next=2;break}return t.abrupt("return");case 2:u=[],c=!0,i=!1,d=void 0,t.prev=6,f=(0,o.default)(n);case 8:if(c=(p=f.next()).done){t.next=19;break}if(m=p.value,h=void 0,!r){t.next=15;break}return t.next=14,r({path:m.path,value:m.value});case 14:h=t.sent;case 15:h&&u.push(h);case 16:c=!0,t.next=8;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(6),i=!0,d=t.t0;case 25:t.prev=25,t.prev=26,!c&&f.return&&f.return();case 28:if(t.prev=28,!i){t.next=31;break}throw d;case 31:return t.finish(28);case 32:return t.finish(25);case 33:return v=!1,x={},a&&n.forEach(function(e){x[e.path]=e.value}),u.length>0&&u.forEach(function(e){x[e.errorPath]=e.message,e.message&&(v=!0)}),x&&e.metaAction.sfs(x),t.abrupt("return",!v);case 38:case"end":return t.stop()}},t,e,[[6,21,25,33],[26,,28,32]])}));return function(e,n,r){return t.apply(this,arguments)}}()};t.default=h,e.exports=t.default},2096:function(e,t,n){"use strict";function r(e){return{formAction:new o.default.action(e)}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2076),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={actionCreator:r},e.exports=t.default}});