webpackJsonp([4],{1878:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,i=n(2),u=o(i),c=n(55),d=o(c),f=n(5),l=o(f),s=n(10),p=o(s),h=n(8),m=o(h),v=n(9),y=o(v),g=n(0),x=(o(g),n(14)),C=(o(x),n(252)),w=n(705),A=o(w),k=(r=(0,C.wrapper)(A.default))(a=function(e){function t(){return(0,l.default)(this,t),(0,m.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){return this.props.monkeyKing((0,u.default)({},this.props,{path:"root"}))}}]),t}(g.Component))||a;t.default=k,e.exports=t.default},1879:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=new g.action(e),n=b.default.actionCreator((0,i.default)({},e,{metaAction:t})),o=new _((0,i.default)({},e,{metaAction:t,extendAction:n})),r=(0,i.default)({},t,n.gridAction,o);return t.config({metaHandlers:r}),r}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=o(a),u=n(568),c=o(u),d=n(569),f=o(d),l=n(5),s=o(l),p=n(10),h=o(p);t.default=r;var m=n(0),v=o(m),y=n(14),g=(o(y),n(252)),x=n(616),C=o(x),w=n(72),A=n(6),k=(o(A),n(11)),R=(o(k),n(1993)),b=o(R),_=function(){function e(t){var n=this;(0,s.default)(this,e),this.onInit=function(e){var t=e.component,o=e.injections;n.extendAction.gridAction.onInit({component:t,injections:o}),n.component=t,n.injections=o,o.reduce("init"),n.load()},this.load=(0,f.default)(c.default.mark(function e(){var t,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,n.webapi.voucher.init({id:n.component.props.voucherId});case 3:o=e.sent,t.voucher=o.voucher,t.educationDataSource=o.educations,t.relaDataSource=o.relas,n.injections.reduce("load",t);case 8:case"end":return e.stop()}},e,n)})),this.prev=(0,f.default)(c.default.mark(function e(){var t,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.metaAction.gf("data.form.id"),e.next=3,n.webapi.voucher.prev(t);case 3:o=e.sent,o&&n.injections.reduce("setVoucher",o);case 5:case"end":return e.stop()}},e,n)})),this.next=(0,f.default)(c.default.mark(function e(){var t,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.metaAction.gf("data.form.id"),e.next=3,n.webapi.voucher.next(t);case 3:o=e.sent,o&&n.injections.reduce("setVoucher",o);case 5:case"end":return e.stop()}},e,n)})),this.add=function(){n.injections.reduce("setVoucher")},this.del=(0,f.default)(c.default.mark(function e(){var t,o,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.metaAction.gf("data.form.id"),e.next=3,n.metaAction.modal("confirm",{title:"删除",content:"确认删除?"});case 3:if(!(o=e.sent)){e.next=10;break}return e.next=7,n.webapi.voucher.del({id:t});case 7:r=e.sent,n.metaAction.toast("success","删除单据成功"),n.injections.reduce("setVoucher",r);case 10:case"end":return e.stop()}},e,n)})),this.save=(0,f.default)(c.default.mark(function e(){var t,o,r,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.metaAction.gf("data.form").toJS(),o=n.checkSave(t),!(o.length>0)){e.next=5;break}return n.metaAction.toast("error",v.default.createElement("ul",{style:{textAlign:"left"}},o.map(function(e){return v.default.createElement("li",null,e)}))),e.abrupt("return");case 5:if(!t.id&&0!=t.id){e.next=12;break}return e.next=8,n.webapi.voucher.update(t);case 8:r=e.sent,r&&(n.metaAction.toast("success","保存单据成功"),n.injections.reduce("setVoucher",r)),e.next=16;break;case 12:return e.next=14,n.webapi.voucher.create(t);case 14:a=e.sent,a&&(n.metaAction.toast("success","保存单据成功"),n.injections.reduce("setVoucher",a));case 16:case"end":return e.stop()}},e,n)})),this.addEducation=(0,f.default)(c.default.mark(function e(){var t,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.metaAction.modal("show",{title:"新增学历",children:n.metaAction.loadApp("mk-app-voucher-education",{store:n.component.props.store})});case 2:if(!(t=e.sent)){e.next=8;break}return e.next=6,n.webapi.education.query();case 6:o=e.sent,n.metaAction.sfs({"data.other.educationDataSource":(0,w.fromJS)(o),"data.form.education":(0,w.fromJS)(t)});case 8:case"end":return e.stop()}},e,n)})),this.educationFocus=(0,f.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.webapi.education.query();case 2:t=e.sent,n.metaAction.sf("data.other.educationDataSource",(0,w.fromJS)(t));case 4:case"end":return e.stop()}},e,n)})),this.educationChange=function(e){var t=n.metaAction.gf("data.other.educationDataSource"),o=t.find(function(t){return t.get("id")==e});n.metaAction.sf("data.form.education",o)},this.metaAction=t.metaAction,this.extendAction=t.extendAction,this.config=C.default.current,this.webapi=this.config.webapi}return(0,h.default)(e,[{key:"checkSave",value:function(e){var t=[];return e.name||t.push("姓名不能为空!"),e.mobile||t.push("手机不能为空!"),e.details&&0!=e.details.length||t.push("家庭情况不能为空！"),e.details.forEach(function(e,n){e.name||t.push("家庭情况第"+(n+1)+"行，家庭成员姓名不能为空！"),e.rela||t.push("家庭情况第"+(n+1)+"行，关系不能为空！")}),t}}]),e}();e.exports=t.default},1880:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=new f.reducer(e),n=v.default.reducerCreator((0,i.default)({},e,{metaReducer:t})),o=new y((0,i.default)({},e,{metaReducer:t,extendReducer:n}));return(0,i.default)({},t,n.gridReducer,o)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=o(a),u=n(5),c=o(u);t.default=r;var d=n(72),f=n(252),l=n(616),s=o(l),p=n(706),h=n(6),m=(o(h),n(1993)),v=o(m),y=function e(t){var n=this;(0,c.default)(this,e),this.init=function(e,t){return n.metaReducer.init(e,(0,p.getInitState)())},this.load=function(e,t){var o=t.voucher,r=t.educationDataSource,a=t.relaDataSource;return e=o?n.metaReducer.sf(e,"data.form",(0,d.fromJS)(o)):n.metaReducer.sf(e,"data",(0,d.fromJS)((0,p.getInitState)().data)),e=n.metaReducer.sf(e,"data.other.educationDataSource",(0,d.fromJS)(r)),e=n.metaReducer.sf(e,"data.other.relaDataSource",(0,d.fromJS)(a))},this.setVoucher=function(e,t){return t?n.metaReducer.sf(e,"data.form",(0,d.fromJS)(t)):n.metaReducer.sf(e,"data.form",(0,d.fromJS)((0,p.getInitState)().data.form))},this.metaReducer=t.metaReducer,this.config=s.default.current};e.exports=t.default},1893:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1894),a=o(r),i=n(1895),u=o(i);t.default={action:a.default,reducer:u.default},e.exports=t.default},1894:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),a=o(r),i=n(51),u=o(i),c=n(2),d=o(c),f=n(46),l=o(f),s=n(5),p=o(s),h=n(10),m=o(h),v=n(11),y=o(v),g=n(14),x=o(g),C=function(){function e(t){var n=this;(0,p.default)(this,e),this.onInit=function(e){var t=e.component,o=e.injections;n.component=t,n.injections=o},this.isSelectAll=function(e){if(n.option){"string"==typeof e&&e||(e=(0,l.default)(n.option)[0]);var t=n.metaAction.gf(n.option[e].path);return!(!t||0==t.size)&&t.every(function(t){return t.get(n.option[e].selectFieldName)})}},this.selectAll=function(e){return function(t){n.option&&("string"==typeof e&&e||(e=(0,l.default)(n.option)[0]),n.injections.reduce("selectAll",t.target.checked,e))}},this.getSelectedCount=function(e){if(n.option){"string"==typeof e&&e||(e=(0,l.default)(n.option)[0]);var t=n.metaAction.gf(n.option[e].path);if(!t||0==t.size)return 0;return t.filter(function(t){return!!t.get(n.option[e].selectFieldName)}).size}},this.mousedown=function(e){if(n.option){var t=y.default.path.findPathByEvent(e);if(!n.metaAction.isFocus(t))if(-1!=t.indexOf("cell.cell"))n.focusCell(n.getCellInfo(t),t);else{if(!n.metaAction.focusByEvent(e))return;setTimeout(n.cellAutoFocus,16)}}},this.gridKeydown=function(e){if(n.option){var t="";if(37!=e.keyCode&&39!=e.keyCode&&13!=e.keyCode&&108!=e.keyCode&&9!=e.keyCode&&38!=e.keyCode&&40!=e.keyCode||(t=y.default.path.findPathByEvent(e))&&-1!=t.indexOf(",")){if(37==e.keyCode){if(!y.default.dom.cursorAtBegin(e))return;return void n.moveEditCell(t,"left")}if(39==e.keyCode||13==e.keyCode||108==e.keyCode||9==e.keyCode){if(!y.default.dom.cursorAtEnd(e))return;return void n.moveEditCell(t,"right")}return 38==e.keyCode?void n.moveEditCell(t,"up"):40==e.keyCode?void n.moveEditCell(t,"down"):void 0}}},this.cellAutoFocus=function(){y.default.dom.gridCellAutoFocus(n.component,".editable-cell")},this.getCellClassName=function(e,t,o){if(n.option){"string"==typeof o&&o||(o=(0,l.default)(n.option)[0]);var r=n.option[o].cellClassName,a=n.metaAction.isFocus(e)?r+" editable-cell":"";return t&&(a+=" "+r+"-"+t),a}},this.dateOpenChange=function(e){if(!e){var t=x.default.findDOMNode(n.component).querySelector(".editable-cell");if(t&&-1!=t.className.indexOf("datepicker")){t.querySelector("input").focus()}}},this.addRow=function(e){return function(t){n.injections.reduce("addRow",e,t.rowIndex+1)}},this.delRow=function(e){return function(t){n.injections.reduce("delRow",e,t.rowIndex)}},this.metaAction=t.metaAction,t.gridOption&&(this.option=t.gridOption)}return(0,m.default)(e,[{key:"getColNames",value:function(e){return this.option[e].getColNames(this.metaAction.gf)}},{key:"moveEditCell",value:function(e,t){var n=this.getCellInfo(e);this.moveCell(n,t,e)}},{key:"moveCell",value:function(e,t,n){var o=function(e,t,n){return!1},r=(0,l.default)(this.option),a=!0,i=!1,c=void 0;try{for(var f,s=(0,u.default)(r);!(a=(f=s.next()).done);a=!0){var p=f.value;-1!=n.indexOf(p)&&this.option[p].cellIsReadonly&&(o=this.option[p].cellIsReadonly)}}catch(e){i=!0,c=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw c}}var h=y.default.matrix.move(e.rowCount,e.colCount,{x:e.x,y:e.y},t);h.x===e.x&&h.y===e.y||(o(h,n,this.metaAction.gf)?this.moveCell((0,d.default)({},e,h),t,n):this.focusCell((0,d.default)({},e,h),n))}},{key:"focusCell",value:function(e,t){var n=(0,l.default)(this.option),o=!0,r=!1,i=void 0;try{for(var c,d=(0,u.default)(n);!(o=(c=d.next()).done);o=!0){var f=c.value;if(-1!=t.indexOf(f)){var s,p=this.getColPathPrefix(t,f);this.metaAction.sfs((s={"data.other.focusFieldPath":""+p+this.getColNames(f)[e.x]+".cell.cell,"+e.y},(0,a.default)(s,"data.other."+f+"ScrollToRow",e.y),(0,a.default)(s,"data.other."+f+"ScrollToColumn",e.x+1),s))}}}catch(e){r=!0,i=e}finally{try{!o&&d.return&&d.return()}finally{if(r)throw i}}setTimeout(this.cellAutoFocus,16)}},{key:"getColPathPrefix",value:function(e,t){return e.substring(0,e.indexOf(t))+t+".columns."}},{key:"getCellInfo",value:function(e){if(this.option){var t=y.default.path.parsePath(e),n=(0,l.default)(this.option),o=!0,r=!1,a=void 0;try{for(var i,c=(0,u.default)(n);!(o=(i=c.next()).done);o=!0){var d=i.value;if(-1!=e.indexOf(d)){var f=this.getColPathPrefix(e,d),s=this.metaAction.gf(this.option[d].path).size,p=this.getColNames(d).length,h=t.path.replace(f,"").replace(".cell.cell","").replace(/\s/g,"");return{x:this.getColNames(d).findIndex(function(e){return e==h}),y:Number(t.vars[0]),colCount:p,rowCount:s}}}}catch(e){r=!0,a=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw a}}}}}]),e}();t.default=C,e.exports=t.default},1895:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(72),i=function e(t){var n=this;(0,r.default)(this,e),this.selectAll=function(e,t,o){if(!n.option)return e;var r=n.option[o].path,a=n.option[o].selectFieldName,i=n.metaReducer.gf(e,r);if(!i||0==i.size)return e;for(var u=0;u<i.size;u++)e=n.metaReducer.sf(e,r+"."+u+"."+a,t);return e},this.addRow=function(e,t,o){if(!n.option)return e;var r=n.option[t].path,i=n.option[t].emptyRow||{},u=n.metaReducer.gf(e,r);return u=u.insert(o,(0,a.Map)(i)),n.metaReducer.sf(e,r,u)},this.delRow=function(e,t,o){if(!n.option)return e;var r=n.option[t].path,i=n.metaReducer.gf(e,r);return-1==o?e:(i=i.remove(o),0==i.size&&(i=i.insert(o,(0,a.Map)({}))),n.metaReducer.sf(e,r,i))},this.metaReducer=t.metaReducer,t.gridOption&&(this.option=t.gridOption)};t.default=i,e.exports=t.default},1993:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(){return{details:{path:"data.form.details",selectFieldName:"selected",cellClassName:"mk-app-voucher-cell",emptyRow:{},getColNames:function(e){return["name","rela","mobile","birthday","isWork"]}}}}function a(e){return{gridAction:new f.default.action((0,c.default)({},e,{gridOption:r()}))}}function i(e){return{gridReducer:new f.default.reducer((0,c.default)({},e,{gridOption:r()}))}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),c=o(u),d=n(1893),f=o(d);t.default={actionCreator:a,reducerCreator:i},e.exports=t.default}});